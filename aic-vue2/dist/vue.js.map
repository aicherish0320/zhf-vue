{"version":3,"file":"vue.js","sources":["../src/compiler/generate.js","../src/compiler/parseHTML.js","../src/compiler/index.js","../src/vdom/patch.js","../src/lifecycle.js","../src/utils.js","../src/observe/array.js","../src/observe/index.js","../src/state.js","../src/init.js","../src/vdom/index.js","../src/render.js","../src/index.js"],"sourcesContent":["export function generate(ast) {\n  let children = genChildren(ast)\n  let code = `_c('${ast.tag}',${\n    ast.attrs.length ? genProps(ast.attrs) : undefined\n  }${children ? `,${children}` : ''})`\n  return code\n}\n\nfunction genChildren(el) {\n  const children = el.children\n  if (children) {\n    return children.map((child) => gen(child)).join(',')\n  }\n  return false\n}\nfunction gen(el) {\n  const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\n  if (el.type === 1) {\n    return generate(el)\n  } else {\n    const text = el.text\n    if (!defaultTagRE.test(text)) {\n      return `_v('${text}')`\n    }\n    // 如果正则 + g，配合 exec 就会有一个问题 lastIndex\n    let lastIndex = (defaultTagRE.lastIndex = 0)\n    let match,\n      tokens = []\n    while ((match = defaultTagRE.exec(text))) {\n      let index = match.index\n      if (index > lastIndex) {\n        tokens.push(JSON.stringify(text.slice(lastIndex, index)))\n      }\n      tokens.push(`_s(${match[1].trim()})`)\n      lastIndex = index + match[0].length\n    }\n    if (lastIndex < text.length) {\n      tokens.push(JSON.stringify(text.slice(lastIndex)))\n    }\n\n    return `_v(${tokens.join('+')})`\n  }\n}\nfunction genProps(attrs) {\n  let str = ''\n  for (let i = 0; i < attrs.length; i++) {\n    const attr = attrs[i]\n    if (attr.name === 'style') {\n      const styles = {}\n      attr.value.replace(/([^;:]+):([^;:]+)/g, function () {\n        styles[arguments[1].trim()] = arguments[2].trim()\n      })\n      attr.value = styles\n    }\n    str += `${attr.name}:${JSON.stringify(attr.value)},`\n  }\n  return `{${str.slice(0, -1)}}`\n}\n","export function parseHTML(html) {\n  const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*` // 匹配标签名\n  const qnameCapture = `((?:${ncname}\\\\:)?${ncname})`\n  const startTagOpen = new RegExp(`^<${qnameCapture}`) // 匹配开始标签名\n  const endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`) // 匹配标签结束 </aa>\n  const attribute =\n    /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/ // 匹配属性\n  const startTagClose = /^\\s*(\\/?)>/ // 匹配结束标签 > />\n\n  let stack = []\n  let root = null\n\n  function createASTElement(tag, attrs, parent = null) {\n    return {\n      tag,\n      type: 1,\n      children: [],\n      parent,\n      attrs\n    }\n  }\n\n  function start(tag, attrs) {\n    const parent = stack[stack.length - 1]\n    const element = createASTElement(tag, attrs, parent)\n    if (!root) {\n      root = element\n    }\n    if (parent) {\n      element.parent = parent\n      parent.children.push(element)\n    }\n    stack.push(element)\n  }\n  function text(text) {\n    const parent = stack[stack.length - 1]\n    text = text.replace(/\\s/g, '')\n    if (text) {\n      parent.children.push({\n        type: 2,\n        text\n      })\n    }\n  }\n  function end(tag) {\n    stack.pop()\n  }\n\n  while (html) {\n    let index = html.indexOf('<')\n    if (index === 0) {\n      const startTagMatch = parseStartTag()\n      if (startTagMatch) {\n        start(startTagMatch.tagName, startTagMatch.attrs)\n        continue\n      }\n\n      let endTagMatch\n      if ((endTagMatch = html.match(endTag))) {\n        end(endTagMatch[1])\n        advance(endTagMatch[0].length)\n        continue\n      }\n    }\n    // 文本\n    if (index > 0) {\n      let chars = html.substring(0, index)\n      text(chars)\n      advance(chars.length)\n    }\n  }\n\n  function parseStartTag() {\n    const startMatch = html.match(startTagOpen)\n    if (startMatch) {\n      const match = {\n        tagName: startMatch[1],\n        attrs: []\n      }\n      advance(startMatch[0].length)\n      // 匹配属性\n      let end, attr\n      while (\n        !(end = html.match(startTagClose)) &&\n        (attr = html.match(attribute))\n      ) {\n        match.attrs.push({\n          name: attr[1],\n          value: attr[3] || attr[4] || attr[4]\n        })\n        advance(attr[0].length)\n      }\n      if (end) {\n        advance(end[0].length)\n      }\n      return match\n    }\n    return false\n  }\n\n  function advance(len) {\n    html = html.substring(len)\n  }\n\n  return root\n}\n","import { generate } from './generate'\nimport { parseHTML } from './parseHTML'\n\nexport function compileToFunction(el) {\n  // template -> ast -> render\n  const ast = parseHTML(el)\n  const code = generate(ast)\n  console.log(code)\n  const render = new Function(`with(this){ return ${code} }`)\n  return render\n}\n","export function patch(el, vnode) {\n  const elm = createElm(vnode)\n\n  const parentNode = el.parentNode\n  parentNode.insertBefore(elm, el.nextSibling)\n  parentNode.removeChild(el)\n\n  return elm\n}\n\nfunction createElm(vnode) {\n  const { tag, data, children, text, vm } = vnode\n  if (typeof tag === 'string') {\n    vnode.el = document.createElement(tag)\n    children.forEach((child) => {\n      vnode.el.appendChild(createElm(child))\n    })\n  } else {\n    vnode.el = document.createTextNode(text)\n  }\n  return vnode.el\n}\n","import { patch } from './vdom/patch'\n\nexport function mountComponent(vm) {\n  const updateComponent = () => {\n    vm._update(vm._render())\n  }\n  updateComponent()\n}\nexport function lifecycleMixin(vue) {\n  vue.prototype._update = function (vnode) {\n    const vm = this\n\n    vm.$el = patch(vm.$el, vnode)\n  }\n}\n","export const isFunction = (v) => typeof v === 'function'\nexport const isObject = (v) => typeof v === 'object' && v !== null\n","const oldArrayPrototype = Array.prototype\n\nexport const arrayProto = Object.create(oldArrayPrototype)\n\nconst methods = ['push', 'pop', 'shift', 'unshift', 'sort', 'splice', 'reverse']\n\nmethods.forEach((m) => {\n  arrayProto[m] = function (...args) {\n    oldArrayPrototype[m].call(this, ...args)\n\n    let inserted\n    switch (m) {\n      case 'push':\n      case 'unshift':\n        inserted = args\n        break\n      case 'splice':\n        inserted = args.slice(2)\n        break\n    }\n    if (inserted) {\n      const ob = this.__ob__\n      ob.observeArray(inserted)\n    }\n  }\n})\n","import { isObject } from '../utils'\nimport { arrayProto } from './array'\n\nclass Observer {\n  constructor(data) {\n    if (Array.isArray(data)) {\n      Object.defineProperty(data, '__ob__', {\n        enumerable: false,\n        value: this\n      })\n      data.__proto__ = arrayProto\n      this.observeArray(data)\n    } else {\n      this.walk(data)\n    }\n  }\n  walk(data) {\n    Object.keys(data).forEach((key) => {\n      defineReactive(data, key, data[key])\n    })\n  }\n  observeArray(data) {\n    data.forEach((item) => {\n      observe(item)\n    })\n  }\n}\n\nfunction defineReactive(obj, key, value) {\n  observe(value)\n  Object.defineProperty(obj, key, {\n    get() {\n      return value\n    },\n    set(newVal) {\n      if (value !== newVal) {\n        value = newVal\n      }\n    }\n  })\n}\n\nexport function observe(data) {\n  if (!isObject(data)) {\n    return\n  }\n  new Observer(data)\n}\n","import { observe } from './observe'\nimport { isFunction } from './utils'\n\nexport function initState(vm) {\n  let data = vm.$options.data\n  vm._data = data = isFunction(data) ? data.call(vm) : data\n\n  // 数据响应式处理\n  observe(data)\n\n  // 将数据代理到 vm 实例上，方便用于使用\n  for (const key in data) {\n    proxy(vm, key, '_data')\n  }\n}\n\nfunction proxy(vm, key, source) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[source][key]\n    },\n    set(val) {\n      vm[source][key] = val\n    }\n  })\n}\n","import { compileToFunction } from './compiler'\nimport { mountComponent } from './lifecycle'\nimport { initState } from './state'\n\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this\n    vm.$options = options\n    // 初始化状态\n    initState(vm)\n\n    // 挂载\n    if (this.$options.el) {\n      this.$mount(this.$options.el)\n    }\n  }\n\n  Vue.prototype.$mount = function (el) {\n    const vm = this\n    const options = this.$options\n\n    el = document.querySelector(el)\n\n    vm.$el = el\n\n    if (!vm.render) {\n      let template = options.template\n      if (!template) {\n        template = el.outerHTML\n      }\n\n      options.render = compileToFunction(template)\n    }\n    mountComponent(vm)\n  }\n}\n","export function createElement(vm, tag, data = {}, ...children) {\n  return vnode(vm, tag, data, children, data.key, undefined)\n}\nexport function createText(vm, text) {\n  return vnode(vm, undefined, undefined, undefined, undefined, text)\n}\n\nfunction vnode(vm, tag, data, children, key, text) {\n  return {\n    vm,\n    tag,\n    data,\n    children,\n    key,\n    text\n  }\n}\n","import { isObject } from './utils'\nimport { createElement, createText } from './vdom'\n\nexport function renderMixin(Vue) {\n  Vue.prototype._c = function () {\n    const vm = this\n    return createElement(vm, ...arguments)\n  }\n  Vue.prototype._v = function (text) {\n    const vm = this\n    return createText(vm, text)\n  }\n  Vue.prototype._s = function (val) {\n    if (isObject(val)) {\n      return JSON.stringify(val)\n    }\n    return val\n  }\n\n  Vue.prototype._render = function () {\n    const vm = this\n\n    const { render } = vm.$options\n\n    const vnode = render.call(vm)\n    return vnode\n  }\n}\n","import { initMixin } from './init'\nimport { lifecycleMixin } from './lifecycle'\nimport { renderMixin } from './render'\n\nfunction Vue(options) {\n  this._init(options)\n}\n\ninitMixin(Vue)\nrenderMixin(Vue)\nlifecycleMixin(Vue)\n\nexport default Vue\n"],"names":["generate","ast","children","genChildren","code","tag","attrs","length","genProps","undefined","el","map","child","gen","join","defaultTagRE","type","text","test","lastIndex","match","tokens","exec","index","push","JSON","stringify","slice","trim","str","i","attr","name","styles","value","replace","arguments","parseHTML","html","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","stack","root","createASTElement","parent","start","element","end","pop","indexOf","startTagMatch","parseStartTag","tagName","endTagMatch","advance","chars","substring","startMatch","len","compileToFunction","console","log","render","Function","patch","vnode","elm","createElm","parentNode","insertBefore","nextSibling","removeChild","data","vm","document","createElement","forEach","appendChild","createTextNode","mountComponent","updateComponent","_update","_render","lifecycleMixin","vue","prototype","$el","isFunction","v","isObject","oldArrayPrototype","Array","arrayProto","Object","create","methods","m","args","call","inserted","ob","__ob__","observeArray","Observer","constructor","isArray","defineProperty","enumerable","__proto__","walk","keys","key","defineReactive","item","observe","obj","get","set","newVal","initState","$options","_data","proxy","source","val","initMixin","Vue","_init","options","$mount","querySelector","template","outerHTML","createText","renderMixin","_c","_v","_s"],"mappings":"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"}
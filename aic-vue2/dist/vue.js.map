{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/observe/array.js","../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export const isFunction = (v) => typeof v === 'function'\nexport const isObject = (v) => typeof v === 'object' && v !== null\n","const oldArrayPrototype = Array.prototype\n\nexport const arrayProto = Object.create(oldArrayPrototype)\n\nconst methods = ['push', 'pop', 'shift', 'unshift', 'sort', 'splice', 'reverse']\n\nmethods.forEach((m) => {\n  arrayProto[m] = function (...args) {\n    console.log('劫持数组', m)\n    oldArrayPrototype[m].call(this, ...args)\n\n    let inserted\n    switch (m) {\n      case 'push':\n      case 'unshift':\n        inserted = args\n        break\n      case 'splice':\n        inserted = args.slice(2)\n        break\n    }\n    if (inserted) {\n      const ob = this.__ob__\n      ob.observeArray(inserted)\n    }\n  }\n})\n","import { isObject } from '../utils'\nimport { arrayProto } from './array'\n\nclass Observer {\n  constructor(data) {\n    if (Array.isArray(data)) {\n      Object.defineProperty(data, '__ob__', {\n        enumerable: false,\n        value: this\n      })\n      data.__proto__ = arrayProto\n      this.observeArray(data)\n    } else {\n      this.walk(data)\n    }\n  }\n  walk(data) {\n    Object.keys(data).forEach((key) => {\n      defineReactive(data, key, data[key])\n    })\n  }\n  observeArray(data) {\n    data.forEach((item) => {\n      observe(item)\n    })\n  }\n}\n\nfunction defineReactive(obj, key, value) {\n  observe(value)\n  Object.defineProperty(obj, key, {\n    get() {\n      return value\n    },\n    set(newVal) {\n      if (value !== newVal) {\n        value = newVal\n      }\n    }\n  })\n}\n\nexport function observe(data) {\n  if (!isObject(data)) {\n    return\n  }\n  new Observer(data)\n}\n","import { observe } from './observe'\nimport { isFunction } from './utils'\n\nexport function initState(vm) {\n  let data = vm.$options.data\n  vm._data = data = isFunction(data) ? data.call(vm) : data\n\n  // 数据响应式处理\n  observe(data)\n\n  // 将数据代理到 vm 实例上，方便用于使用\n  for (const key in data) {\n    proxy(vm, key, '_data')\n  }\n}\n\nfunction proxy(vm, key, source) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[source][key]\n    },\n    set(val) {\n      vm[source][key] = val\n    }\n  })\n}\n","import { initState } from './state'\n\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this\n    vm.$options = options\n    // 初始化状态\n    initState(vm)\n  }\n}\n","import { initMixin } from './init'\n\nfunction Vue(options) {\n  this._init(options)\n}\n\ninitMixin(Vue)\n\nexport default Vue\n"],"names":["isFunction","v","isObject","oldArrayPrototype","Array","prototype","arrayProto","Object","create","methods","forEach","m","args","console","log","call","inserted","slice","ob","__ob__","observeArray","Observer","constructor","data","isArray","defineProperty","enumerable","value","__proto__","walk","keys","key","defineReactive","item","observe","obj","get","set","newVal","initState","vm","$options","_data","proxy","source","val","initMixin","Vue","_init","options"],"mappings":"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"}